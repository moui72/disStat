```{r setup, include=FALSE}
knitr::opts_chunk$set(
	echo = FALSE,
	fig.height = 3,
	message = FALSE,
	warning = FALSE
)
library(huxtable)
library(readr)
library(jsonlite)
library(dplyr)
library(knitr)
library(kableExtra)
br <- function() {
  if(knitr::is_html_output()){
    return("<br/>")
  } else {
    return("/linebreak")
  }
}
```

# Methodology 

This section outlines the methodology employed for the reported study. The methodology outlined is referred to as the *Double Reading Procedure* and was first implemented by @fodor2019center. In this procedure, participants are asked to read sentences twice, once without taking any time to preview it(Reading 1), and then again after unlimited preview (Reading 2). @fodor2019center wanted to investigate the extent to which preview impacted the prosodic phrasing of center embedded sentences, as well as whether or not readers would find the doubly center-embedded sentences more comprehensible after preview (or, comprehensible at all, as the doubly center embedded sentences often were not on first attempt). In the prosody literature up to this point, preview has largely been ignored as a factor in reading aloud tasks. The @fodor2019center study found that preview did indeed impact both prosodic grouping that readers used and comprehensibility. While the questions being asked here are different, we are still concerned with the prosody that is produced, and the difficulty the reader experiences in parsing a sentence read aloud. This experimental paradigm eliminates the possible noise of not knowing whether a given pronunciation represents a considered or naive attempt to read a sentence aloud.

## Participants recruitment

The participants in this study were all undergraduate students enrolled in Psychology 101. These students were required by thire university to participant in studies for course credit. Self reported age ranged from 18 to 25 years. Participants were recruited using the Queens College Sona system, which is software designed for university participant pools. Students saw a notice on the Sona website (see Appendix \ref{sec:rec}) and were able to schedule their own appointment time within the hours offered.

All participants were self identified native and primary speakers of American English. One participant was disqualified post-hoc after producing a Caribbean English pronunciation pattern; one other participant was excluded post-hoc due to an extremely disfluent reading cadence. Both excluded participants were still awarded class credit for participating.

## Location

All data were collected in a private room with only the experimenter and participant present. While every effort was undertaken to ensure a quiet environment, intrusive noise from passersby or neighboring rooms were sometimes unavoidable. This resulted in some unusable or partially unusable recordings (discussed in section \@ref(sec:irtRes) of the results chapter).

## Equipment and software

The experiment was presented on a laptop running Windows 10 with stickers on the keyboard labeling relevant keys. The left shift key was labeled *START*, right shift was labeled *NEXT*, and the touch-pad was labeled *DONE*.

The presentation of items and instruction[^instr] was done using the Open Sesame software [@os2012] which provides a graphical user interface, scripting language, and interpretation of Python code, for precise control of experimental presentation.

Recording was done using a Blue Yeti USB microphone position near the participant's left hand and angled to point at the space in front of the participant's mouth. The angle was adjusted for each participant's height. It recording 44.1kHz single-channel audio.

[^instr]: Instructions were also provided verbally and via printout. Details on the instructions are available in the appendices.

## Materials

In total there were 16 experimental items in 4 versions each, and 32 fillers in two versions each. The design decisions are discussed in detail in this section.

### Experimental items

The goal in creating the experimental items was to have four versions of each item: a declarative garden path (D+GP), a declarative non-garden path (D-GP), an interrogative garden path (Q+GP) and an interrogative non-garden path (Q-GP). The experimental stimuli are based on earlier pilot study exploring this same phenomenon [@qp2], but with several issues with that study's experimental items corrected.  The structure of the items are, schematically, something like (@schema).

  (@schema) [Subject] [Verb-cluster: AUX + Matrix + Main] [Object] [PP1] [PP2]
  
PP1 is always interpretable as either a modifier of the object NP or as the goal argument of the main verb; i.e. it is temporarily ambiguous. As a reminder, the running assumption is that the parser will initially assume PP1 to be the goal argument and attach it high (as an argument of the verb). For the +GP cases, PP2 will be incompatible with that structure and force reanalysis, so that PP1 attaches low as a modifier of the object and PP2 attaches high as the verbal argument. For the -GP cases, conversely, PP2 will be compatible with high attachment of PP1, i.e. will attach low as a modifier of PP1's embedded NP. An example item in its four versions is provided in table \@ref(tab:sentences).

```{r sentences}
sentences <-cbind( 
  c(
    "D-GP",
    "Q-GP" ,
    "D+GP",
    "Q+GP"
  ), 
  c(
    "He had intended to cram the paperwork in the drawer of his filing cabinet.",
    "Had he intended to cram the paperwork in the drawer of his filing cabinet?",
    "He had intended to cram the paperwork in the drawer into his boss's desk.",
    "Had he intended to cram the paperwork in the drawer into his boss's desk?"
  )
)
colnames(sentences) <- c("Version","Sentence")
kable(sentences, booktabs=T, caption="Experimental item in four versions")
```
The reason for using a complex verb cluster (auxiliary + matrix + main) rather than a single verb has two parts. The purpose of the auxiliary is to eliminate differences across items: an interrogative version, +GP or -GP, is always identical to its declarative counterpart in every way, except for inversion of the order of the subject and auxiliary verb, and the replacement of a final period with a final question mark. If an auxiliary verb were not present, then the interrogatives would have an extra word, so-called *do*-support, that does not appear in the declarative (e.g. *she put ...* vs. *did she put ...?*). The auxiliary is always *had* and the past participle is always one of the following four: *decided*, *intended*, *wanted*, and *planned*. The purpose of the past participle matrix verbs is to partially alleviate the oddity of the yes/no questions. It seems quite odd to ask, "did she put the jelly beans in the window onto a fancy dish?" because, when it’s clear that the speaker already knows so much about the situation, it becomes difficult to imagine a pragmatically plausible context where the question would be asked. Such sentences might be described as “prosecutorial[^dcbp].” Arguably, this is somewhat mitigated by the addition of a verb like *decided*: rather than asking about facts that we already seem to know, we are instead asking about the actor's intention with regard to something that may or may not have taken place. Even if we know the facts of the situation, we do not necessarily know for instance whether it was the result of a decision, some third party's action, or merely happenstance. Another concession to this concern is to limit the amount of detail in the sentence (e.g. fewer adjectives and adverbs compared to the items in @qp2) and to limit the subject to always being a first person nominative pronoun (he or she).

[^dcbp]: Thank you to Dianne Bradley for making this observation, and for the very clever “prosecutorial” descriptor.

Importantly, the main verb needs to be one which obligatorily takes a PP goal argument. One of these issues with the items from [@qp2] was that the some of the verbs used only optionally took a goal[^goalmod]. Verbs that only optionally take a goal are likely to result in a parse where PP1 is not immediately incorporated as the goal argument, but rather be incorporated as a modifier of the object, which would mean that PP2 would not force reanalysis. Consider the contrasting sub-categorization of the verbs in (@weak-@strong):

[^goalmod]: Because "optional argument" is arguably a contradictory term, I refrain from referring to goals that are not obligatory as "arguments"; I will instead call them goal modifiers of the verb, or just goals.

  (@weak) Weak PP-argument sub-categorization (*hide*) 
  
  a. The gangsters had hidden the shotguns in a U-Haul truck in an old outhouse. 
  b. \checkmark The gangsters had hidden the shotguns.
            
  (@strong) Strong PP-argument sub-categorization (*cram*) 
  
  a. Justin had crammed the old newspapers under the couch in a small wastebasket.
  b. \* Justin had crammed the old newspapers.

A verb like *hide*, as in (@weak), can take a goal, but is also able to do without one. A verb like *cram*, on the other hand, as in (@strong), really must have a goal. In designing the items for this study, only verbs that require a goal argument were used in order to maximize the likelihood of a robust garden path effect in the +GP versions, when PP2 triggers reanalysis. The four verbs used in this study were: *cram*, *put*, *stick* and *set*. 

Another important consideration was ensuring that the +GP versions had a PP2 which fully disambiguated the attachment site of PP1 such that reanalysis is forced. In (@ambig), PP2 is implausible as a modifier of *rocking horse*, but not strictly impossible, and the sentence is certainly grammatical with low attachment of PP2. On the other hand, the use of *onto* in (@disam) completely disallows the low attachment of PP2 at the syntactic level: a PP headed by *onto* simply cannot modify the preceding NP.

  (@ambig) She had decided to put the child [~PP1~ on the rocking horse] [~PP2~ **on** the see-saw].
  (@disam) She had decided to put the child [~PP1~ on the rocking horse] [~PP2~ **onto** the see-saw].
  
Where [@qp2] relied on plausibility to force reanalysis, this study uses syntactic disambiguation, such that the +GP versions always have a PP2 headed by *into* or *onto* This avoids any discrepency between individuals' belief of what is plausible from impacting the parse obtained.

For the -GP items, the head preposition of PP2 was always either *from* or *of* (half and half, 8 each), which are compatible with a parse where PP1 is the goal argument and PP2 is modifying the NP within PP1. While *from* can be read as a goal argument, the assumptions made about how parsing works lead this to be an unlikely analysis, and *of*-headed PPs certainly cannot be a goal argument.

It's worth noting that some linguists believe *of* is not a preposition in the same sense as *from*, *on*, or *in*, etc. It's also importantly only 2 characters, whereas *into*, *onto*, and *from* (the other possible heads of PP2) are all 4 characters. This is revisted and its impact is explored in the results section.

The preposition that headed PP1 was always one which was compatable with a goal argument: *in* (8), *on* (7), and in one case, *under*. PP1 is the same across versions of a given item.

To sum up, the experimental items were designed to have limited detail, with either he or she as the subject. A complex verb cluster, e.g. had decided to cram was used to facilitate subject-auxiliary inversion in the interrogatives and limit the difference between items, as well as provide a verb of intent (decided, intended, or wanted) to support pragmatically plausible questions. PP1 is always compatible with attaching as either the goal argument or a modifier of the object. PP2 differs across the garden path condition: in +GP versions, it will be headed by into or onto and thereby trigger reanalysis, as such PPs must be parsed as the goal argument, the position that PP1 had presumably previously occupied in the ongoing parse. For -GP versions PP2 will be headed by from or of and therefore not require reanalysis, as from- and of-headed PPs can attach as modifiers of the preceding NP and so allow PP1 to stay in the goal argument slot.

### Fillers

There were 32 filler items that ranged in complexity. Of these 32, 16 were designed to end in a sequence of two PPs, to mirror the experimental items (+PP). The other half contained no final PPs (-PP). All fillers were designed in two versions: declarative (D) and interrogative (Q). The +PP fillers were not related to the -PP fillers.

  (@fillerdpp) He had forgotten to try the famous pastry in the restaurant of the fancy hotel.
  (@fillerqpp) Had he forgotten to try the famous pastry in the restaurant of the fancy hotel?
  
  (@fillerd) She had forgotten to report that the clerk was ignoring her request.
  (@fillerq) Had she forgotten to report that the clerk was ignoring her request?

A full list of fillers is available in appendix \ref{sec:fillers}. Fillers were not limited to the four main verbs of the experimental item, but did always follow the same pattern of *had* followed by a past participle. The past participle was always one of the four used for experimental item (*intended*, *decided*, *planned*, and *wanted*), or one of these additional four: *forgotten*, *remembered*, *meant*, or *needed*, with each of the 8 past participles being used twice in the +PP fillers and twice in the -PP fillers, for a total of 4 times each.

### Length

Length was tightly controlled across items. For experimental items, all sentences were between 66 and 75 characters long, and between 13 and 15 words long. The length never varied across the &plusmn;Q condition. Across the &plusmn;GP condition there was a maximum length difference of one character. Two items varied in word length across &plusmn;GP by one word. For all length variations (word and character), an equal number were longer in the +GP condition as in the -GP condition. They ranged from 18 to 22 syllables.

Control over filler length was slightly less stringent. They ranged from 63 to 79 characters and 12 to 14 words. 

## Experimental groups and order of items

No participant saw more than one version of each sentence, and each participant saw one version of every sentence. Each participant saw the same number of each type of sentence: 4 garden path declaratives, 4 garden path interrogatives, 4 non-garden path declaratives and 4 non-garden path interrogatives. The experimental item were presented in pseudo-random order, interspersed with 1 to 3 fillers and with two experimental items never occurring in the same version twice in a row (e.g. after declarative garden path, the next experimental item was never also a declarative garden path).

The four versions of the experimental sentences resulted in four groups. A split-half ordering (where the first 24 of the items presented to one group was the second 24 presented to the other) resulted in 2 versions for each group, and so there were 8 groups in total.


## Procedure

Participants were given a verbal overview of the experimental procedure and then asked to read a one page printout of the procedure before signing a consent form. After signing a consent form, participants sat at the computer and were once again walked through instructions before the first practice item was presented.

Participants sat at a computer and used keyboard button presses to navigate the experimental presentation. They received thorough instructions and completed three practice items, the consulted with the experimenter, before beginning the main portion of the study. The study also contained 4 pseudo-practice items that were not included in any analyses, in order to allow some time for the participant to settle into the procedure before any results were recorded.

Each experimental item was preceded by a screen showing a line of ten Xes with its left edge aligned with the left edge of the to-be-revealed sentence. This was intended to fix the participant's attention on the start of the sentence, and hopefully avoid unintended look-ahead. The issue of potential look-ahead is discussed at greater length in section \ref{sec:look-ahead}

This screen remained visible indefinitely, until the participant pressed *START*.

Immediately after *START* was pressed, recording of the first reading began and the sentence appeared on the screen on a blue background. The recording continued and the screened remained visible until the participant pressed *NEXT*. After pressing *NEXT*, a screen appeared with instructions telling the participant that they were between readings, and needed to press *START* to reveal the sentence again and prepare for their second reading. Immediately after *START* was pressed, the first recording ended and the second recording began, and the sentence reappeared, this time on a green background.

![Procedure diagram](dissertation-procedure.png)

The shifting of required key presses and the changing background color were intended to aid the participant in remember where they were in the process, and to prevent accidental double-presses of any given button from having unintended side effects. It took some time for the participants to adapt to the somewhat complicated procedure, but generally were well adjusted by the time the first item was presented.

### On look-ahead {#look-ahead}

An advantage that the Double Reading Procedure has is that it allows for certain assumptions to be made about Reading 2 that otherwise would be unclear: Reading 2 certainly represents a considered reading of the sentence. Not only has the reader had ample time to examine the sentence, they have necessarily read it, and they have heard themselves read by way of producing Reading 1. This means Reading 2 can plausibly be thought to represent a considered prosodic structure, at least more so than an entirely naive reading, and it should not represent any processing issues, because a parse should have already been obtained during Reading 1, or during subsequent study of the sentence prior to Reading 2.

The nature of Reading 1 is less clear. Because there is variability in the delay between the display of the sentence and the onset of phonation, it’s possible that Reading 1 is not entirely without preview. The properties of these Reading 1 delays are discussed at length in a later section, but for now it suffices to say that the amount of preview that is possible during a delay that typically falls in the 0.2 to 2.7s range (median = 1s, SD = 0.4) is limited. As an example of common reading rates, Ashby et al. (2012) reported faster readers as averaging 328 words per minute (wpm), and slower readers 228wpm in silent reading. That study found that reading time is slower for reading aloud, and that the availability of parafoveal information (i.e. the difference between 1 word and 3 word windows) is less impactful for that reading mode. Given that the experimental items range from 13 to 15 words, most of the R1 delays would not allow even a fast reader to read the entire sentence: the median 1s R1 delay would allow a fast reader time to read only between 5 and 6 words. The utterance of Reading 1 should, for most recordings, contain within it any behavioral reflex of whatever parsing difficult the reader has.

In order to clearly understand the results of this double reading study, it’s important to understand the mechanics of reading. Specifically, we would want to know at what point during their reading of the sentence the participant will become aware of the existence of the disambiguating PP2, since this is when they will realize that their parse is going to crash. The work of several decades on this subject is thoroughly summarized in @rayner2012psychology. They describe reading as consisting of a series of fixations, where the eyes attend to a specific point, and saccades, where the eyes move ahead ballistically (i.e. on a planned trajectory that cannot be interrupted). A consequence of the ballistics property of saccade movement and the additional finding that the landing sites (fixations) are not random, we can infer that at least some lookahead is available, i.e. the reader must know something about what is coming in order to choose a suitable landing site. The primary predictor of fixation point seems to be the character length of a word, meaning that the presence of characters and word boundary information (represented orthographically by spaces) at least are necessary at the periphery of attention, i.e. within the perceptual span. Some details on the perceptual span, or the information that can be accessed by the eyes at any given time, is discussed in brief, with special attention to its relevance for the study at hand.

@rayner2012psychology discuss a number of studies that explore the size and properties of this span, the most fruitful of which is the gaze-contingent moving-window technique. In this technique, text is presented on a video monitor while the reader is also hooked up to eye-tracking equipment. A computer samples the position of the reader’s eyes every millisecond and updates the display. Using this elaborate system, and the mutilation of text outside a window of clear text, they can create a so-called moving window around the reader’s point of fixation. By manipulating the size of this window, they were able to determine that reading speed is maximized when about 15 characters to either side of the fixation site. Later, they discovered that this is actually asymmetric, and the window need only go as far as the start of currently fixated word in the direction of what has already been read (to the left, for English readers). In order to determine how much information was available at the periphery of the perceptual span, they manipulated how much information was destroyed outside the window of clear text, and used a window size known to be smaller than the ideal (21 characters, 10 to either side). They used a condition where all characters and spaces were replaced with xs, essentially destroying all information outside the window. They compared reading speeds with this system to one where character spaces were maintained, but all other information was obscured, as well as to one where characters were replaced with characters that had similar shape (i.e., the same pattern of ascenders and descenders) as the character they replaced, with and without spaces. Finally, they also looked at a mask where characters were replaced with dissimilar substitutes, with and without spaces. 

Using these techniques and again manipulating the size of the window, they were able to determine that it is only word boundary information that is available at the extreme edge of the perceptual span; character shape (ascenders and descenders) is available about 10 characters out from the fixation point, and character identity is available more or less only for the fixated word.

The relevant question for the study at hand is, how much of the sentence will the reader have seen and processed when they are pronouncing a given word? A typical item is displayed in (@dtc), with the words expected to be fixated underlined, numbered by presumed fixation sequence, and labeled. The number of characters intervening before the start of the disambiguating region (the left edge of PP2) is displayed below each label. These counts are from the initial character of the fixated word to the initial character of the disambiguating region; the actual fixation site is likely to be closer to the center of the word, meaning the distance would be shortened by a few (1-4) characters, depending on the length of the fixated word.

  (@dtc) ![](distance-to-cr.png)
  
Table \@ref(tab:dtcs) describes these distances across items all experimental items. Note that these values do not vary across condition, because counting starts after both the subject and auxiliary verb, and ends before PP2, and the only changes across versions are subject-auxiliary inversion and the content of PP2. 

```{r dtcs}
csv <- '
MEDIAN,46,34.5,25.5,7.5
MAX,50,38,27,9
MIN,45,32,21,5
'

tab <- read_csv(csv, col_names = F)

tab %>% kable(
  col.names = c(" ","1-INITIAL","2-CONSTRUCTION VERB","3-OBJ","4-PP1"),
  align="rccc", 
  caption="Distance in characters from fixation to disambiguation in experimental items"
) %>% 
  kable_styling(latex_options = "hold_position")
```

From the initial fixation point, the distance to disambiguation ranges from 45 to 50 characters, with a median of 46 characters.  If we recall that word boundary information is available 15 to 18 characters to the right of fixation, we can be certain that the disambiguating region is far out of view until several fixations in.

So, when does the reader become aware of the existence of PP12? When fixated on the direct object head noun, the range of distance is 21 to 27 characters, with a median of 25.5: still outside of view, even in the case of the smallest distance, and adjusting it to be a few characters smaller to account for the fact that fixation is likely to occur closer to the center of the word rather than on its first character. At most, the presence of the first few characters of PP2’s preposition may be available, but certainly not the character space after it. The distance from the PP1 fixation point (the head noun within that PP) ranges from 5 to 9 characters, with a median between 7 and 8 characters. Thus, we can say with some certainty that the reader of a sentence such as (1) will be aware that another phrase, one which starts with a 4 character word, remains to be incorporated into their parse sometime after they have processed the direct object, and before they have finished processing PP1.

There is yet another piece to consider: the so-called eye-voice span (EVS), and the fact that the readers in this study are reading aloud rather than silently. According to @evs, when reading aloud the voice is typically behind the eyes by about 10-20 characters (M = 16.2 characters, SD = 5.2 characters). If we adjust table 1 by subtracting 16 from each cell, we can approximate the position of the voice when the disambiguating region comes within the perceptual span. These values are shown in table \@ref(tab:evsdtcr).


```{r evsdtcr}
csv <- '
MEDIAN,30,18.5,9.5,-8.5
MAX,34,22,11,-7
MIN,29,16,5,-11
'

tab <- read_csv(csv, col_names = F)

tab %>% kable(
  col.names = c(" ","1-INITIAL","2-CONSTRUCTION VERB","3-OBJ","4-PP1"),
  align="rccc", 
  caption="EVS-adjusted character distance to disambiguation in experimental items"
) %>% 
  kable_styling(latex_options = "hold_position")
```

It is likely, then, that the voice would actually still be on the object when the eyes discover the existence of PP2, and will still be pronouncing PP1 when the eyes are first fixated on PP2. This raises a question about any prosodic breaks produced after the object, because it is difficult to distinguish between an intentional prosodic break at that point, versus the reader using a natural break for hesitation related to the garden path effect of discovering the disambiguating PP2.

## Inter-reading time (IRT) measurement {#irt}

Subjects were asked to read each sentence twice, once with no preview at all (reading 1, a cold reading), and then again after unlimited preview (reading 2, a previewed reading). Inter-reading time (IRT) is a measure of the amount of time between when a subject stops speaking after a cold reading and when they begin speaking for a previewed reading.

```{r metasetup}

## meta 
json <- read_file("../meta-4_11.json")
meta<-fromJSON(json)
handset <- read.csv("../csvs/_SITA_SET_VALUES.csv")
meta[meta$file %in% handset$Filename,]$agg <- NA
meta[meta$file %in% handset$Filename,]$hpf <- NA
meta<-cbind("P"=read.table(text=meta$file, sep=".")[[1]],meta)
hscount <- sum(handset$Filename %in% meta$file)
meta<-subset(meta,P != 8)
```

IRT was measured using a Python script and Google's WebRTC Voice Activity Detection (VAD) over 44.1kHz WAV files down-sampled to 8kHz via SOX[^upsamp]. This VAD system uses Gaussian Mixture Models to make probabilistic decisions on whether a given audio frame is speech or noise (see @gmm1 for a complete explanation). Google's implementation takes one parameter, which they call aggressiveness: a 4-tier setting for the level of confidence necessary to call a given frame speech. I call this "rejection rate", where a higher rejection rate means that the model requires a high level of confidence before assuming a frame is speech, i.e. it is more likely to label something noise than speech. The implementation codes this setting as 0-3, where 0 is the most lenient (most likely to label a frame as speech) and 3 is the most stringent (most likely to label a frame as noise).

[^upsamp]: Google's VAD API only accepts WAV files with sample rates that are a multiple of 8kHz. It ultimately down-samples all files to 8kHz, regardless of the input rate.

The recordings vary in the volume of the speaker's voice and the amount of background noise present. An algorithm was constructed to allow for the most stringent measurement of the least modified data that gave plausible measurements. Specifically, each file was measured using the highest possible rejection rate for the VAD algorithm and no modification of the file. If the timings detected were not plausible, the timings were re-measured with the same rejection rate, but after the recording had undergone a 200Hz high-pass filter[^alg] (HPF). If that still failed, a 400Hz HPF was used. After a further failure, the rejection rate for the VAD was lowered, and the whole thing was tried again (0, 200Hz, 400Hz); and that process was itself repeated until the lowest possible rejection rate was tried of the four possible settings. 

A plausible set of measurements had to meet the following criteria:

*Utterance length:* An utterance length between 2s and 10s, where utterance timing is the longest contiguous span in the recording that VAD reports as phonation, with breaks in phonation of less than 1s not breaking contiguity (@goldman1961-pa found that a large majority (82.5 to 87%) of pauses in fluent speech are less than 1s). Stimuli range from 18-22 syllables in length. If we assume a speech rate of 3 to 7 syllables per second [@jacewicz2010-sr] we would expect utterances between 2.5s and 7.3s. Conservative thresholds higher and lower than the expected were used, especially on the higher end, to allow for any difficulties processing or fluency that might have lead to longer reading times.

*Minimum leading silence:* A leading silence ("delay") of more than 120ms. Even a very fast human reaction time should not permit a delay shorter than 120ms, so a shorter delay likely means something went wrong with the procedure and the participant is already speaking before the sentence is displayed.

*Maximum edge silence:* A maximum trailing and leading silence length of less than 95% of the file's length was also used, in order to filter out recordings that do not represent a valid trial. Very long silences less than this very conservative threshold that impact the IRT are dealt with in the data clean up rather than via phonation detection, as described in the results section of this paper (section \ref{sec:irtDis}).

With 32 participants reading 48 items (experimental and filler) twice each, there are an expected number of `r 32*48*2` recordings; due to technical issues at the time of data collection, `r 32*48*2 - nrow(meta)` recordings are missing. Of the `r nrow(meta)` recordings subjected to this treatment, `r nrow(meta[meta$success & !is.na(meta$agg),])` resulted in plausible timings. For those that were successful, the breakdown of HPF and rejection rate used is reported in Table \@ref(tab:metable). A further `r hscount` were set by hand, resulting in a total of `r nrow(meta[meta$success,])` recordings.

[^alg]: The exact algorithm is available on [github](https://gist.github.com/moui72/4ebc4eb8f69eb9fdb1cab160ce299675) (URL: [bit.ly/2uMrcrG](https://bit.ly/2uMrcrG))

```{r metable}
metaTable<-xtabs(~agg+hpf, meta[meta$success,])
row.names(metaTable)<-c("Lowest VAD rejection rate","...","...","Highest VAD rejection rate")
kable(
  metaTable, 
  col.names = c("No HPF", "HPF at 200Hz", "HPF at 400Hz"),
  caption="VAD rejection rate and high pass filter (HPF) values",
  booktabs=T
) %>% kable_styling(latex_options = "hold_position")
```

### Timing measurement reliability

Timings were collected by hand for `r 384*2` recordings (`r round(384*2 / nrow(meta) * 100,1)`% of all data). Human measured timings were within 100ms of the VAD-measured timings in `??`%[^hh] of cases.

[^hh]: NOTE: Hand measurement is not yet completed.

## Prosodic judgments

A trained linguist informant naive to the research being conducted listened to recordings and reported the presence or absence of breaks in certain regions of the sentence, as well as several other judgments. She was instructed to familiarize herself with a speaker's speech patterns before rating any recordings by listening to 6 filler item recordings from that speaker. She was given a diagram of the sentences as in table \ref{tab:reg}, as well as full plain-text lists of all items.

```{r reg}
Sentence = c(
  "He", 
  "had", 
  "meant", 
  "to stick ||$_{V}$", 
  "the pencil case ||$_{OBJ}$", 
  "in the cabinet ||$_{PP1}$", 
  "into his book bag."
)
Syntax = c(
  "NP$_{SUBJ}$",
  "AUX", "V$_1$",
  "V$_2$", 
  "NP$_{OBJ}$",
  "PP$_1$", 
  "PP$_2$"
)

region = c("SUBJ", " ", "V", " ", "OBJ", "PP1", "PP2")
tab = rbind(Sentence,Syntax)
colnames(tab) <- region
kable(tab, booktab=T, caption="Sentence region labels", escape=F,row.names = F) %>% 
  kable_styling(latex_options = c("scale_down","hold_position"))

```

She was asked to report on whether or not she heard a prosodic boundary directly after the region labeled **V**, directly after the region labeled **OBJ**, and directly after the region labeled **PP1**. The following definition of prosodic break was provided:

>Please work with the assumption that “prosodic boundary” in what follows is any subset of the following features, clustered in such a way as to trigger your intuition that a new prosodic element (of any size) is beginning: pitch change, volume change, segmental lengthening, or pause.

The judgments requested also included whether or not the speaker struggled, where that struggle began, whether or not the speaker used question intonation, and which break(s) were stronger or more prominent than which other break(s). 

Detailed instructions on the order in which items should be listened to, both within speaker and across speakers, were also provided. The result was that she never listened to both readings of a sentence in sequence; she never listened to two reading 1 versions of different sentences in sequence; and she never listened to the sentences in the same order for a given participant as she did for the previous one.

Details on the instructions given and the judgments collected can be found in the appendices (\ref{sec:RA}).

### Reliability

A second trained linguist repeated the task over 128 recordings selected from 8 participants (two from each group, one per ordering). Even number experimental items were used from 4 participants, and odd numbered from the other 4. There were 8 recordings missing from the 128 selected, so the reliability task resulted in judgments over 120 recordings. The first informant also blindly re-rated those 120, with the recording name obscured and instructions not to revisit her original ratings. Reliability scores (percent of recordings agreed upon) are reported in table \ref{tab:validity}.

```{r validitySetup}
library(irr)
library(readr)
all <- read_csv2("export/prosody_validity.csv")
# columns to iterate
vals = c("V","OBJ","PP1","STRONG","WEAK","STRUG","STRUG_START","QI")
# raters to compare to main
suffixes=c("-dr","-sp")

# comps will hold string rep of Agr%, Kappa, (z) *pval*
comps <- matrix(nrow=6,ncol=length(vals))
colnames(comps)<-vals

# aggs will hold just agree%
aggs <- matrix(nrow=2,ncol=length(vals),dimnames = list(suffixes))
colnames(aggs)<-vals

# for each col...
for(val in vals) {
  # for each rater...
  sufn = 0
  for(suf in suffixes) {
    row = 3 * sufn + 1
    sufn = sufn + 1
    # d is 120 rows, 2 col, where col[1] = main, col[2] = suf rater
    d <- cbind(all[[paste0(val)]],all[[paste0(val,suf)]])
    a <-kappa2(d)
    ag <- agree(d)
    aggs[suf,val] <- paste0(ag$value,"%")
    
    comps[row,val] <- sprintf(
      "%0.1f%%",
      ag$value
    )
    comps[row+1,val] <- sprintf(
      "K = %0.2f%s",
      a$value,
      ifelse(a$p.value < 0.001,"***",
             ifelse(a$p.value < 0.01,"**",
                    ifelse(a$p.value < 0.05,"*",
                      ifelse(a$p.value < 0.1," .",
                             "")))))
    comps[row+2,val] <- sprintf(
      "(z = %0.2f)",
      a$statistic
    )
    
    # comps[suf,val] <- sprintf(
    #   "%0.1f%s %0.2f%s <br> (z = %0.2f)",
    #   ag$value,
    #   "% <br> K = ",
    #   a$value,
    #   ifelse(a$p.value < 0.001,"***",
    #          ifelse(a$p.value < 0.01,"**",
    #                 ifelse(a$p.value < 0.05,"*",
    #                   ifelse(a$p.value < 0.1," .",
    #                          "")))),
    #   a$statistic
    # )
  }
}

comps <- comps %>% as.data.frame()
labels <- matrix(c(rep("Inter-rater",3),rep("Intra-rater",3)))
comps <- cbind(labels,comps)
```

```{r validity}
kable(
  comps,
  caption="Inter and intra-rater agreement with Cohen's Kappa", 
  booktab=T, 
  digits=2,
  align="c",
  escape=knitr::is_latex_output(),
  col.names=c(" ","V","OBJ","PP1","STRONGEST","WEAKEST","STRUGGLED","START REGION","FINAL RISE")
) %>%
  kable_styling(latex_options = c("hold_position","scale_down")) %>%
  add_header_above(c(" " = 1, "Breaks" = 3, "Break strength" = 2, "Struggle" = 2, " " = 1)) %>%
  column_spec(1, bold = T) %>%
  row_spec(c(1:2,4:5), hline_after = F) %>%
  collapse_rows(columns = 1, latex_hline = "major")  %>%
  footnote("*** p < 0.001; ** p < 0.01; * p < 0.05, . p < 0.1") 
```

The lower intra-rater agreement for relative break strength was likely a result of a methodological issue: it was possible to report the same pattern, e.g. a pattern where a PP1 break is stronger than an OBJ break, by either giving the response "PP1" for strongest break, and "OBJ" for weakest break; or, "PP1" for strongest and "NONE" for weakest; or, "NONE" for strongest and "OBJ" for weakest. While the instructions to the rater requested full verbosity, it's likely that inconsistencies occurred for these cases.

The same inconsistencies would have hurt inter-rater agreement for strongest/weakest also. A further contributing issue for inter-rater agreement of those two judgments stems from the poor agreement on the presence of the verb break. When the raters do not agree about the presence of a break, that disagreement is magnified for the judgement of the relative strength of breaks.

